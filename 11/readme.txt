the scoping etc is annoying here, i just copypasted into replit to run 